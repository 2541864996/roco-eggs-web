<html>
<head>
    <meta charset="UTF-8" />
    <script src="https://unpkg.com/vue"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css"/>
    <script src="https://unpkg.com/element-plus"></script>
    <!-- Import ElementPlus Icons-Vue -->
    <script src="https://unpkg.com/@element-plus/icons-vue"></script>
    <title>小草王孵蛋表</title>
    <link rel="icon" href="./img/logo.png" />
    <style>
        #app{
            height: 100%;
            width: 100%;
        }
        .font,.font-title{

            font-size: 16px;
        }
        .font-title{
            font-family: \6977\4f53,serif;
            font-weight: 800;
            font-size: 20px;
        }
        /*页面灰掉样式*/
        .grey{
            -webkit-filter: grayscale(100%);
            -moz-filter: grayscale(100%);
            -ms-filter: grayscale(100%);
            -o-filter: grayscale(100%);
            filter: grayscale(100%);
            filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);
        }

        .info{
            display: flex;
        }
        .info-label{
            background-color: #5d5dd9;
            -webkit-border-bottom-left-radius: 25px;
            -webkit-border-top-left-radius: 25px;
            width: 40px;
        }
        .info-value{
            margin-left: 10px;
        }
        .pokemon{
            display:flex;
            flex-wrap: wrap;
            padding: 5px 0;
        }
        .pokemon-item{
            width: calc((100% - 80px) / 8);
            box-shadow: 2px 2px 6px 1px rgb(50 50 50 / 34%);
            border-radius: 10px;
            margin: 5px;
        }
        .pokemon-img{
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 5px 5px 0 5px;
            position: relative;
            min-height: 100px;
        }
        /*.pokemon-img-loading{*/
        /*    content: "";*/
        /*    height: 100%;*/
        /*    width: 100%;*/
        /*    position: absolute;*/
        /*    left: 0;*/
        /*    top: 0;*/
        /*    background: url("./img/loading.png") no-repeat center;*/
        /*}*/


        .pokemon-item:hover{
            background-color: rgba(58, 142, 230, 0.12);
        }
        /*内容的动画*/
        .pokemon-item {
            -webkit-animation: pokemon-item 0.5s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;
            animation: pokemon-item 0.5s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;
        }
        @-webkit-keyframes pokemon-item {
            0% {
                -webkit-transform: scale(0);
                transform: scale(0);
                opacity: 1;
            }
            100% {
                -webkit-transform: scale(1);
                transform: scale(1);
                opacity: 1;
            }
        }
        @keyframes pokemon-item {
            0% {
                -webkit-transform: scale(0);
                transform: scale(0);
                opacity: 1;
            }
            100% {
                -webkit-transform: scale(1);
                transform: scale(1);
                opacity: 1;
            }
        }

        @media screen and (max-width: 1500px){
            .pokemon-item{
                width: calc((100% - 60px) / 6);
            }
        }
        @media screen and (max-width: 1250px){
            .pokemon-item{
                width: calc((100% - 50px) / 5);
            }
        }
        @media screen and (max-width: 1000px){
            .pokemon-item{
                width: calc((100% - 40px) / 4);
            }
        }
        @media screen and (max-width: 750px){
            .pokemon-item{
                width: calc((100% - 30px) / 3);
            }
        }
        @media screen and (max-width: 500px){
            .pokemon-item{
                width: calc((100% - 20px) / 2);
            }
        }
    </style>
</head>
<body>
<div id="app">
    <div style="height: 100%;background-size: 100%;" :style="'background: rgba(255, 255, 255, 0.5) url(' + backgroundImg() + ');'" :class="greyFlag ? 'grey' : ''">
        <div v-for="(pokemon,index) in Object.keys(pokemonList)" :key="index">
            <div class="info">
                <div class="info-label"></div>
                <div class="info-value font-title">{{pokemon}}</div>
            </div>
            <div class="pokemon font">
                <div v-for="(item,i) in pokemonList[pokemon]" :key="i" class="pokemon-item" :body-style="{ padding: '0' }">
                    <div class="pokemon-img">
                        <img v-if="!item.imgLoading" :src="getPokemonImg(pokemon,item)" style="width: 100%;border-radius: 5px;"/>
                        <img v-if="item.imgLoading" src="./img/loading.gif" style="width: 100%;border-radius: 5px;"/>
                    </div>
                    <div style="padding: 5px">
                        <div>
                            <el-tag style="margin-right: 5px">{{item.name}}</el-tag>
                            <el-tag>{{item.day}}天</el-tag>
                        </div>
                        <div>
                            <span v-for="skill in item.skills">
                                <el-tag :type="skill.type === 1 ? 'success' : skill.type === 2 ? 'info' : 'danger'" style="margin: 5px 5px 0 0">{{skill.name}}</el-tag>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    const{ createApp ,reactive ,toRefs,onMounted, ref }  = Vue;
    const app = createApp({
        setup(){
            const state = reactive({
                backgroundImgList: ["./img/十周年.jpg","./img/十二周年.jpg"],
                greyFlag: 0,//页面置灰
                loading: false,//加载
                imgBaseUrl: './img/宠物/',
                pokemonList:{
                    "乖乖组":[
                        {name:"金冠冥蛇",skills:[{name:"守护之力",type:1},{name:"毒雾",type:1},{name:"反射护盾",type:1},{name:"快意恩仇",type:2}],img:"守护之力-毒雾-反射护盾-快意恩仇-金冠冥蛇.png",day:1,imgLoading:true},
                        {name:"梅花鹿",skills:[{name:"守护之力",type:1},{name:"毒雾",type:1},{name:"快意恩仇",type:2},{name:"冰天雪地",type:2}],img:"守护之力-毒雾-快意恩仇-冰天雪地-梅花鹿.png",day:1,imgLoading:true},
                        {name:"梅花鹿",skills:[{name:"守护之力",type:1},{name:"毒雾",type:1}],img:"守护之力-毒雾-梅花鹿.png",day:1,imgLoading:true},
                        {name:"梅花鹿",skills:[],img:"梅花鹿.png",day:1,imgLoading:true},
                    ],
                    "精灵组":[
                        {name:"雪精灵",skills:[{name:"电磁巨炮",type:1},{name:"极度深寒",type:2},{name:"冰天雪地",type:2},{name:"快意恩仇",type:2}],img:"电磁巨炮-极度深寒-冰天雪地-快意恩仇-雪精灵.png",day:1,imgLoading:true},
                        {name:"冰封怨灵",skills:[{name:"电磁巨炮",type:1},{name:"极度深寒",type:2},{name:"冰天雪地",type:2},{name:"快意恩仇",type:2}],img:"电磁巨炮-极度深寒-冰天雪地-快意恩仇-冰封怨灵.png",day:1,imgLoading:true},
                        {name:"精灵多哥",skills:[{name:"火之刃",type:1},{name:"冰晶结界",type:1},{name:"飞叶刀",type:1},{name:"快意恩仇",type:2}],img:"火之刃-冰晶结界-飞叶刀-快意恩仇-精灵多哥.png",day:1,imgLoading:true},
                        {name:"精灵多哥",skills:[{name:"火之刃",type:1},{name:"冰晶结界",type:1},{name:"幽灵镜",type:1},{name:"快意恩仇",type:2}],img:"火之刃-冰晶结界-幽灵镜-快意恩仇-精灵多哥.png",day:1,imgLoading:true},
                    ],
                }
            })
            //初始化
            const init = () => {
                backgroundImg();
                imgLoading();
            }
            //初始化背景
            const backgroundImg = () => {
                let index = Math.floor(Math.random() * state.backgroundImgList.length);
                // return state.backgroundImgList[index];
                return ""
            }
            //预加载图片
            const imgLoading = () => {
                //得到所有图片进行预加载
                let pokemonKeyList = Object.keys(state.pokemonList);
                pokemonKeyList.forEach(key => {
                    state.pokemonList[key].forEach(item => {
                        let img = new Image()
                        img.src = getPokemonImg(key,item);
                        img.onload = function() {
                           item.imgLoading = false;
                        }
                    })
                })
            }
            /**
             * 获取孵蛋图片
             * @param pokemon 宠物组别
             * @param item 孵蛋信息
             * @returns {string} url
             */
            const getPokemonImg = (pokemon,item) => {
                return state.imgBaseUrl + pokemon + '/' + item.img
            }
            onMounted(() => {
                init();
            });
            return{
                init,
                backgroundImg,
                getPokemonImg,
                ...toRefs(state),
            }
        }
    });
    app.use(ElementPlus);
    app.mount("#app");
</script>
</body>
</html>
